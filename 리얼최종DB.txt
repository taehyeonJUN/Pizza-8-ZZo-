CREATE TABLE MEMBER(
MEM_ID VARCHAR(50) PRIMARY KEY,
MEM_NAME VARCHAR (50) NOT NULL,
MEM_PW VARCHAR(50) NOT NULL,
MEM_PN VARCHAR(50) NOT NULL,
ROL VARCHAR(50) DEFAULT 'USER',
CONSTRAINT MEMBER_CH_ROL CHECK (ROL IN('ADMIN','USER')
));
COMMIT;
SELECTFROM MEMBER;

CREATE TABLE MENU(
ME_ID NUMBER(10,0) PRIMARY KEY,
ME_NAME VARCHAR (50) NOT NULL,
ME_PRICE INT NOT NULL,
ME_SORT VARCHAR(50) NOT NULL,
CONSTRAINT MENU_CH_SORT CHECK (ME_SORT IN('TOPPING','SIDE','SIZE')
));
SELECTFROM MENU;

CREATE TABLE LIST(
LI_ID NUMBER(10,0) PRIMARY KEY,
LI_USER VARCHAR (50) NOT NULL,
LI_MEID NUMBER(10,0) NOT NULL,
LI_MEPRICE INT NOT NULL,
LI_EA NUMBER(10,0) NOT NULL,
LI_OR_NUM NUMBER(10,0) NOT NULL,
FOREIGN KEY(LI_OR_NUM) REFERENCES PIORDER(OR_ID) ON DELETE CASCADE
);
SELECTFROM LIST;
DROP TABLE LIST;
COMMIT;
CREATE TABLE PIORDER(
OR_ID NUMBER(10,0) PRIMARY KEY,
OR_USER VARCHAR (50) NOT NULL,
OR_UNAME NUMBER(10,0) NOT NULL,
OR_UPN VARCHAR(50) NOT NULL,
OR_UAD VARCHAR(50) NOT NULL,
OR_PRICE INT NOT NULL,
OR_PAY VARCHAR(20) DEFAULT 'CARD',
FOREIGN KEY(OR_USER) REFERENCES MEMBER(MEM_ID) ON DELETE CASCADE,
CONSTRAINT PIORDER_CH_OR_PAY CHECK (OR_PAY IN('CASH','CARD','SAMSUNG_PAY')
));
SELECTFROM PIORDER;

CREATE TABLE TMP_LIST AS
SELECTFROM LIST;
COMMIT;

TRUNCATE TABLE LIST;

ALTER TABLE LIST MODIFY(LI_MEPRICE INT);

INSERT INTO LIST SELECTFROM TMP_LIST;




CREATE TABLE BBS(
BBS_ID NUMBER(10,0) PRIMARY KEY,
BBS_USER VARCHAR2 (50) NOT NULL,
BBS_TITLE VARCHAR2(50) NOT NULL,
BBS_TEXT CLOB,
BBS_DATE DATE DEFAULT SYSDATE,
FOREIGN KEY(BBS_USER) REFERENCES MEMBER(MEM_ID) ON DELETE SET NULL
);
COMMIT;
SELECTFROM BBS;

CREATE TABLE RP(
RP_ID NUMBER(10,0) PRIMARY KEY,
RP_USER VARCHAR2 (50) NOT NULL,
RP_TEXT CLOB,
RP_BBSID NUMBER(10,0),
RP_DATE DATE DEFAULT SYSDATE,
FOREIGN KEY(RP_USER) REFERENCES MEMBER(MEM_ID) ON DELETE SET NULL,
FOREIGN KEY(RP_BBSID) REFERENCES BBS(BBS_ID) ON DELETE CASCADE
);
COMMIT;


INSERT INTO MENU VALUES(SEQ_ME.NEXTVAL,'치즈',39800,'TOPPING');
INSERT INTO PIORDER VALUES(SEQ_OR.NEXTVAL,(SELECT MEM_ID FROM MEMBER WHERE MEM_ID='A001'),'배범수','010-7764-5181','파주',30000,'CARD');
INSERT INTO LIST VALUES(SEQ_LI.NEXTVAL,(SELECT MEM_ID FROM MEMBER WHERE MEM_ID='A001'),(SELECT ME_ID FROM MENU WHERE ME_ID=1),20000,3,(SELECT OR_ID FROM PIORDER WHERE OR_ID=4));
INSERT INTO LIST VALUES(SEQ_LI.NEXTVAL,(SELECT MEM_ID FROM MEMBER WHERE MEM_ID='A001'),(SELECT ME_ID FROM MENU WHERE ME_ID=1),1212,63,(SELECT OR_ID FROM PIORDER WHERE OR_ID=4));
INSERT INTO BBS VALUES(SEQ_BBS.NEXTVAL,(SELECT MEM_ID FROM MEMBER WHERE MEM_ID='A001'),'철권','철권하고픔',SYSDATE);
INSERT INTO RP VALUES(SEQ_RP.NEXTVAL,(SELECT MEM_ID FROM MEMBER WHERE MEM_ID='A001'),'HI',(SELECT BBS_ID FROM BBS WHERE BBS_ID=1),SYSDATE);
COMMIT;
SELECTFROM RP;
--UPDATE MEMBER SET MEM_NAME = '관리자' WHERE MEM_ID='ADMIN';

CREATE SEQUENCE SEQ_LI
INCREMENT BY 1
START WITH 1
MINVALUE 1;

CREATE SEQUENCE SEQ_ME
START WITH 1;

CREATE SEQUENCE SEQ_OR
START WITH 1;
COMMIT;

CREATE SEQUENCE SEQ_BBS
START WITH 1;
COMMIT;

CREATE SEQUENCE SEQ_RP
START WITH 1;
COMMIT;

SELECTFROM ALL_CONSTRAINTS
WHERE TABLE_NAME='PIORDER';

